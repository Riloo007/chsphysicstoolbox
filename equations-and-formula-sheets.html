<html>
<head>
  <title>CHS Physics Toolbox</title>
  <!--
    // These scripts are modular and don't work in Chrome Version 103.0.5060.134 (Official Build) (64-bit)
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js"></script>

    Copyright 2023 Glitch
  -->
  <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-database.js"></script>

  <script src="pageTools.js"></script>
  <link rel="stylesheet" href="style.css"></style>
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600&display=swap" rel="stylesheet">
</head>

<body>
  <div style="height: 40px;"></div>
  <header id="header"></header>
  <div class="contentWrapper" id="contentWrapper">
    <div class="locationIndex" id="locationIndex">Formulas</div>
    <div class="messageContainer">
      <h1 id="Heading">Equations and Formula Sheets</h1>
      <div class="" id="Content">
        <p>Select your physics level</p>
        <div class="menu-flex-container" id="menu-flex">
          <div onclick="loadList(10)">
            Physics 10
          </div>
          <div onclick="loadList(20)">
            Physics 20
          </div>
          <div onclick="loadList(30)">
            Physics 30
          </div>
        </div>
        <div class="menu-flex-container-button" onclick="loadList(40)">
          View All >
        </div>
      </div>
    </div>
  </div>
  
  <footer id="footer"></footer>
</body>

<div style="display: none;" id="Template">
  <div class="flex-container">
    <div id="FormulaContainer">
      <div id="Formula"></div>
      <div id="WordFormula"></div>
    </div>
    <div id="VariableContainer">
      <!--<img src="cube.gif" height="300px">
      <br>
      <h2>
          Energy
      </h2>
      <br>
      <p>
          Energy, measured in Joules.
      </p>
      <br>-->
    </div>
  </div>
</div>

<script>
    var physicsLevel;
    var NetHTMLList;
    var readyToPush = 3;

    // Firebase Load List
    function loadList(i) {
      NetHTMLList = "";
      if(i == 40){
        document.getElementById("locationIndex").innerHTML += " > All";
        document.getElementById("Heading").innerHTML = "All Formulas";
        readyToPush = 3;
        loadFormulaList(10);
        loadFormulaList(20);
        loadFormulaList(30);
      } else {
        readyToPush = 1;
        loadFormulaList(i);
      }
    }
    function loadFormulaList(i) {
        physicsLevel = i;

        //document.getElementById('message').innerHTML = "Loading... Please wait"
        //document.getElementById('menu-flex').innerHTML = "";
        var HTMLList = "";
        const listRef = database.ref('Formulas/' + pad(i) + "/list");
        listRef.on('value', function(snapshot){
            list = snapshot.val();
            console.log(list);
            listLen = Object.keys(snapshot.val()).length;
            for(i=0; i<listLen; i++) {
                console.log(list[pad(i+1)]);
                HTMLList += "<div onclick='loadEquationData(" + (i+1) + ")'>" + generateMathHtml(list[pad(i+1)]) + "</div>";
                console.log("[LIST]: ", HTMLList);
            }
            NetHTMLList += HTMLList;
            readyToPush -= 1;

            if(readyToPush == 0) {
              // Push list to HTML
              document.getElementById('Content').innerHTML = NetHTMLList;
              document.getElementById('Content').classList += "menu-flex-container";
            }
            //document.getElementById('menu-flex').innerHTML = HTMLList;
            //document.getElementById('message').innerHTML = "Choose a formula to view:"
        })

    }

    function loadEquationData(i) {
        document.getElementById('message').innerHTML = "Loading... Please wait"
        document.getElementById('menu-flex').innerHTML = "";
        var HTMLList = "";
        
        const listRef = database.ref('Formulas/' + physicsLevel + "/longList/" + pad(i));
        listRef.on('value', function(snapshot){
            info = snapshot.val();
            console.log(info);
            console.log(info["Formulas"]);
            actuallyLoadEquationData(info);
        })
    }

    function actuallyLoadEquationData(info) {
        activeFormula = info["Formulas"]["01"];

        document.getElementsByTagName("body")[0].innerHTML = document.getElementById("Template").innerHTML;
        document.getElementById("Formula").innerHTML = (generateMathHtml(activeFormula));
        //document.getElementById("WordFormula").innerHTML = (wordFormula);
    }

    function selectVariable(i) {

    }
    

  </script>